\chapter{Introduction}
\label{sec:intro}

\section{Motivation}

% TODO: Definition of Distraction
%       https://www.diva-portal.org/smash/record.jsf?pid=diva2%3A675328&dswid=-4959
% TODO: Why not supervised learning?

Fully autonomously driving cars have the potential to rule out human driving error, which is at least a contributing factor to most accidents today. Many social and technical obstacles have yet to be overcome until fully autonomous cars become market-ready \parencite{autonomous_driving_book}. Cars will likely not be able to drive fully autonomously in the near future, continuing to require some degree of human supervision and intervention (\cite{human-needed}, and \cite{human-needed-2}). Before the introduction of fully autonomous driving, two transitional stages are conceivable \parencite{shared_control}: First, partially autonomous driving refers to the partial relinquishment of the responsibility of the driver. Only specific tasks, such as lane-keeping or cruise control, are delegated to an assistance system, while the driver retains the responsibility for other tasks. Second, conditional automation goes one step further; the car is controlled autonomously. Only if intervention by the driver is deemed necessary, the driver is alerted, and control is handed over. 

Increasing intervention by an assistance system limits the driver's autonomy. A loss of autonomy can turn driving into a monotonous and tedious supervisory task. As a result, drivers may distract themselves more frequently \parencite{driver-distraction}, have reduced reaction times \parencite{reaction-time}, suffer from a lower situational awareness \parencite{situational-awareness}, and can place too much trust in the assistance system \parencite{over-trust}. Moreover, in the case of conditional automation, the time required for the driver to shift back to driving from a non-driving task may be too long in critical situations \parencite{takeover-time}. To mitigate these problems, \cite{shared-control-haptics} propose employing a shared control scheme: The driver and the assistance system continuously share the control authority of the car, cooperating in the driving task. The driver is kept in the loop. Thereby, the driving task stays enjoyable, and drivers are prevented from relying too heavily on the assistance systems.

A large part of driving accidents are associated with driver distraction \parencite{distracted_nhtsa}. Therefore, it seems reasonable to make the extend of the assistance dependent on the driver's level of attention. Whenever a driver is inattentive or distracted, an assistance system needs to be particularly sensitive. \cite{disracted-lane-keeping-1} and \cite{disracted-lane-keeping-2} show that increasing the intensity of lane-keeping assistance when the driver is distracted increases lane-keeping performance, while the driver is not influenced in her driving while being attentive. 

However, the detection of driver distraction is complex. Methods like eye movement tracking \parencite{eye-movement}, head tracking \parencite{head-tracking}, and driver gaze monitoring \parencite{gaze-monitoring} have been proposed and proven to be successful. However, they all rely on continuous video recordings and analysis of the driver. This is a privacy intrusion and may not be desirable or impractical (e.g. low-light situations). 

This thesis presents an alternative approach: A \Gls{pomdp} is used to model a shared-control lane-keeping scenario. A driver is assisted by a lane-keeping assistance system that estimates the driver's attentiveness online, based on the driver's past behavior. An explicit measurement of the driver's distraction is not required.

\section{Related work and contributions}

POMDP is a framework to model sequential decision problems (one decision influences the next) in a partially observable environment \parencite{pomdp-definition}. An agent interacts with the environment. After performing an action, the agent receives observations about the environment, and a reward signal. It uses the observations it receives over time to estimate the environment's state in order to decide which actions to perform next in order to maximize the long-term reward.

POMDPs are well suited to model driving problems in which the internal psychological state of a human is important but unknown (such as her intend, goals, drowsiness, or attentiveness). Research mostly focuses on fully autonomous cars assessing the behavior of other traffic participants. By employing a POMDP to model the uncertainty about humans' internal states, improved driving policies were achieved in three, widely studied scenarios: pedestrian avoidance (\cite{despot-crowd}, and \cite{pomdp-pedestrian-avoid-2}), intersection crossing (\cite{pomdp-intersection}, \cite{att_intersec}, \cite{pomdp-intersection-2}, and \cite{pomdp-intersection-3}), and lane changes (\cite{pomdp-lane-changes}, \cite{att_intersec}, \cite{pomdp-lane-changes-2}, \cite{tactical-decision}, and \cite{pomdp_towards_human}). 

The aforementioned studies demonstrate that a POMDP is suitable for dealing with the uncertainty related to a person's internal psychological state and that this can be beneficial for making the right decisions when driving. However, they focus on judging about the state of external drivers. None of them apply POMDPs in a shared control driving scenario. 

% Both papers implement assistance measures that warn the driver, and actively intervene in the car's control. 
\cite{hitl_pomdp} introduce a framework to model shared control, human in the loop sceanrios using POMDPs. The benefits of the framework are exemplified by assisting a potentially drowsy driver with lane-keeping: The assistance system is able to reason about the driver's drowsiness effectively, and can handle noisy or erroneous observations. A driver model is used to simulate human behavior and a simple car model is employed to simulate the car's dynamics in the experiments. However, the approach relies on the availability of observations that strongly correlate with the driver's drowsiness (observation whether the driver's eyes are closed or not).

% \cite{hitl-pomdp-2} use a similar approach to assist a potentially distracted driver in lane-keeping and collision avoidance tasks. 

Research suggests that driver distraction can lead to a change in driving performance. Distracted drivers show certain behaviors, such as lane position deviations, infrequent steering wheel movements, and reduced reaction times \parencite{driver-distraction-review}. \cite{dist-det-perf} show that monitoring driving performance measures (steering wheel angle, heading angle and lateral deviation) alone can be sufficient to detect driver distraction accurately.

In this thesis, an assisted lane-keeping scenario, with a potentially distracted human in the loop, is modeled as a POMDP. The requirement from \cite{hitl_pomdp} of observations that correlate very closely with the driver's psychological state is relaxed. The only observations available to the assistance system are the steering actions of the driver, the car's yaw angle, and its lateral deviation. Moreover, the number of considered discrete steering actions is substantially increased. The driving dynamics are simulated using a realistic driving simulator rather than a simple low-dimensional mathematical model.

% TODO: Lis contributions?

%%%%%%
% Contributions
% \cite{hitl_pomdp} is quite simplistic - action model 




% 1. POMDPs can do what I want them to do
% 2. They have successfully been used in driving settings to model:
%    - Pedestrian avoidance \cite{despot-crowd} \cite{pomdp-pedestrian-avoid-2}
%    - Intersection behavior \cite{att_intersec} \cite{pomdp-intersection} \cite{pomdp-intersection-2} \cite{pomdp-intersection-3}
%    - Lane changing \cite{att_intersec} \cite{tactical-decision} \cite{pomdp_towards_human} \cite{pomdp-lane-changes} \cite{pomdp-lane-changes-2}
%    - Lane keeping
%    - Traffic prediction \cite{pomdp_towards_human}
% 3. Human-in-the-loop approaches (shared control)
%    - Not much research has been conducted in this area
%    - List papers that look at distraction



% Using RL for lane keeping
% End-to-End Deep Reinforcement Learning for LaneKeeping Assist
% Design of a Reinforcement Learning-Based Lane Keeping Planning Agent for Automated Vehicles

% Modeling other people's/ driver's hidden psychological states
% Intention-Aware Online POMDP Planning for Autonomous Driving in a Crowd
% Towards Human-Like Prediction and Decision-Making for Automated Vehicles in Highway Scenarios
% Probabilistic Motion Planning in Uncertain and Dynamic Environments

% Lane change POMDP
% Tactical Decision-Making for Highway Driving

% Intersection POMDP
% 

% Pedestrian avoidance POMDP
% Intention-Aware Motion Planning
% Intention-Aware Online POMDP Planning for Autonomous Driving in  a Crowd
% Closing the Planning-Learning Loop with Application to Autonomous Driving in a Crowd

%%%%%%
% Shared control

% General shared control driving:
% Sharing Control With Haptics: Seamless Driver Support From Manual to Automatic Control

% Drowsy driver: A POMDP Framework for Human-in-the-Loop System


% Improving Human-In-The-Loop Decision Making In Multi-Mode Driver Assistance Systems Using Hidden Mode Stochastic Hybrid Systems
% Lane keeping and lane change - Active control or warning
% Distracted driver
% Distraction is classified by monitoring the driver's smartphone use
% -> The agent has some clear clues on whether the driver is distracted or not. We only base the estimate on the driver's past behavior
% continuous car state is known to the agent
% Reward function includes driver's attentiveness. This is not realistic, as the attentiveness is unknown. 
% Only discrete states are hidden and there are only discrete control inputs.
% Existing commercial driver assistance systems, including automatic braking systems and lane-keeping systems, may monitor the state of the vehicle or the environment to determine whether the systems should intervene. However, the state of the human driver is not typically included in the decision making process. In this paper, we propose to use hidden mode stochastic hybrid systems to model the interaction between the human driver and the vehicle. We show that by monitoring the human behavior as well as the vehicle state, we can infer the human state and enhance the quality of decision making in a driver assistance system.


%%%%%%
% Reward formulations
% \cite{reward1}; \cite{reward2}


\section{Problem overview and research questions}

The problem examined in this thesis is assisted lane keeping with shared control by a potentially distracted human driver and an agent acting as an assistance system. The agent assists the driver in keeping the car centered in its lane. The driver becomes distracted periodically. During distraction episodes, the driver may act suboptimally. The driver's behavior is simulated using a driver model. The driverâ€™s attentiveness is unknown to the agent. It has to infer if the driver is distracted from the driver's past steering activity, and sensory observations about the car's state. The dynamics of the car are simulated using the driving simulator \Gls{torcs}. A POMDP model is employed to accunt for the uncertainty about the driver's attentiveness.

\vspace{1em}
\noindent
\textbf{The following research questions arise:}
\begin{enumerate}
    \item How can a lane-keeping scenario with shared control between a potentially distracted human driver and an agent be modeled using a POMDP?
    % \item Which simplifications are necessary in order to address the problem?
    % \item How can a good policy for the agent be derived from the POMDP?
    % \item How does the agent perform with driver models of increasing complexity?
    % \item What measures are available to improve the agents performance?
    \item Can the agent estimate the driver's distraction using driver performance measures alone, allowing it to take appropriate actions when the driver becomes distracted?
    \item Is the solution approach viable for a real-world scenario, and if not, what limitations are there, and what are potential methods to solve them?
\end{enumerate}

% TODO: Include? Isn't this going a bit too far? It is hard ro explain this without sophisticated background knowledge
% \section{Proposed solution approach}

\section{Outline}

The remaining content of the thesis is organised as follows:
\begin{description}
    \item[\cref{ch:theory}] intoduces the basic theoretical \gls{pomdp} concepts which serve as a foundation for the thesis.

    \item[\cref{ch:problem}]
    presents the methodology that was applied, including the definition of the POMDP used to model the shared control lane-keeping task, and the chosen solution approach.
    
    \item[\cref{ch:setup}]
    describes the experiments that are performed to access the performance of the solution approach.
    
    \item[\cref{ch:results}]
    showcases the results from the experiments.

    \item[\cref{ch:discussion}]
    analyzes the results and elaborates the limitations of the solution approach.

    \item[\cref{ch:discussion}]
    highlights the conclusion, contributions, and challenges for a potential future real-world application.

\end{description}